<!DOCTYPE html>
<html>
  <head>
    <title>Cinema - Progetto SD</title>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href="stile.css" rel="stylesheet"/>
  </head>
  <body>
    <nav id="topnav">
      <div class="voice"><button onclick="mostraProiezioni()">Proiezioni</button></div>
      <div class="voice"><button onclick="alert('hello world')">Prenotazioni</button></div>
      <div class="voice" id="compacter">
        <svg width="100%" height="100%">
          <line/>
          <line/>
          <line/>
        </svg>
      </div>
    </nav>
    <div id = "topnav-space"></div>
    <section id="proiezioni" hidden>
      <h2>List of showings</h2>
      <div id = "locandina"><!--    Lo tengo per la struttura dell'oggetto
        <div class = "item">
          <div class="card">
            <div class="filmTitle">Title</div>
            <div class="illusion">
              <p>Author</p>
              <p>published</p>
              <p>Time</p>
              <p>descrizione</p>
              <button onclick="foo()">Prenota visione</button>
            </div>
          </div>
        </div>-->
      </div>
    </section>
    <section id="prenotazioni" hidden>
      <h2>Prenotazione posti</h2>
      <p>Scegli i posti da prenotare o inserisci la prenotazione da modificare.</p>
      <form action=""></form>
      <div id = "sala">
        <table><!--
          <tr>
            <td>A</td>
            <td class="seat">
              <svg width="40" height="40">
                <circle cx="20" cy="14.4" r="10"/>
                <path d="M 0,40 Q 0,28 12,28 L 28,28 Q 40,28 40,40 Z"/>
              </svg>
            </td>
          </tr>-->
        </table>
      </div>
      <button id="invio">Invia Prenotazione</button>
    </section>
    <footer>
      Comotti Carlo Luca, Condello Alessandro, Elli Martina. Tutti i diritti riservati
    </footer>
    <script src="scripts.js"></script>
    <script>
      /*
      // Funziona di utilità che mostra l'errore nella console e in un alert
      // del browser.
      function onError(msg, error) {
        const out = `${msg}: ${error}`;
        console.error(out);
        alert(out);
      }
      // newContactDOM viene eseguita all'invio del from. Aggiunge un nuovo
      // contatto, prima inviandolo al server e poi mettendolo nella tabella.
      async function newContactDOM(event) {
        // Evito che il form venga davvero inviato.
        event.preventDefault();
        // Recuperi i dati da inviare dal form.
        const name = document.getElementById("input-name");
        const number = document.getElementById("input-number");
        let contact = {
          "name": name.value,
          "number": number.value
        };
        // Pulisco i campi del form, ormai non servono più.
        name.value = "";
        number.value = "";
        try {
          // Creo il nuovo oggetto e lo invio al server, restituisce il
          // nuovo ID.
          contact["id"] = await newContact(contact)
          // Ottengo il nuovo contatto con tutte le informazioni.
          contact = await getContact(contact["id"]);
          // Infine lo aggiungo alla tabella.
          addContactDOM(contact);
        } catch (error) {
          onError("Failed to add a new user", error);
        }
      }
      // addContactDOM aggiunge il contatto fornito in una nuova riga della tabella.
      function addContactDOM(contact) {
        // Selezione di <tbody> e aggiunta di una nuova riga.
        const tbody = document.getElementById("table-body");
        const row = tbody.insertRow();

        // Aggiunta dell'ID.
        const id = row.insertCell();
        id.setAttribute("align", "center");
        const idText = document.createTextNode(contact["id"]);
        id.appendChild(idText);

        // Aggiunta del nome.
        const name = row.insertCell();
        name.setAttribute("align", "center");
        const nameText = document.createTextNode(contact["name"]);
        name.appendChild(nameText);

        // Aggiunta del numero.
        const number = row.insertCell();
        number.setAttribute("align", "center");
        const numberText = document.createTextNode(contact["number"]);
        number.appendChild(numberText);
      }
      // Ho definito init come una funzione asincrona, per cui l'esecuzione è slegata
      // dal flusso sequenziale dello script. Il browser si occupa di gestire queste
      // funzioni, che prima o poi verranno eseguite e completate.
      */
     
      /*
      async function init() {
        // getUsers è asincrona, per cui restituisce una Promise che verrà eseguita
        // in modo asincrono. Il metodo then permette di eseguire due funzioni: la
        // prima in caso di successo, la seconda in caso di errore.
        getContacts().then((users) => users.forEach(addContactDOM),
          (error) => onError("Failed to get users", error));

        // Aggiungo l'handler per l'evento di invio al form.
        const form = document.getElementById("add-contact");
        form.addEventListener("submit", newContactDOM);
      }*/
      window.onload = init();
    </script>
  </body>
</html>